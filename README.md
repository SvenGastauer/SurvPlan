# SurvPlan

Author: Sven Gastauer and Matthias Schaber, Feb. 2023  
Institute: [Th√ºnen Institute for Sea Fisheries](https://www.thuenen.de/en/institutes/sea-fisheries) , Operational Observation Systems   

## Copyright and licence  
    Copyright (C) 2023 Sven Gastauer.
    
    This file is part of SurvPlan.  
    
    GNU GENERAL PUBLIC LICENSE
                       Version 3, 29 June 2007
  
    Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
    Everyone is permitted to copy and distribute verbatim copies
    of this license document, but changing it is not allowed.
    
## Citation
Please cite as:
  Gastauer S, Schaber M (2023). SurvPlan: Acoustic Survey Planner. R package version 0.1.0.
Bibtex for LateX users:
```
  @Manual{,
    title = {SurvPlan: Acoustic Survey Planner},
    author = {Sven Gastauer and Matthias Schaber},
    note = {R package version 0.1.0},
  }
 ```
## Description  
Transect Planner for acoustic surveys

![alt text](https://github.com/SvenGastauer/SurvPlan/blob/main/inst/extdata/app.png?raw=true)  


## Package Installation  

Install package with vignettes:  
```
devtools::install_github("SvenGastauer/SurvPlan", build_vignettes = TRUE)
```

## Usage  

### Starting the app  
After the package is installed, the shiny app can be launched:  
```
library(SurvPlan)
planner()
```  
The app will open in a new browser window as shown above.  

### Load strata description  
First you will need to load a csv file containing the polygon or strata descriptions. An example file for the North Sea Herring Acoustic Survey (HERAS) region can be found within the package:
```
system.file("extdata", "HERAS_Strata_2022.csv", package="SurvPlan")
``` 
Once loaded, a map will show the loaded transects.  

#### Generate your own stratum csv file  
You can also generate your own strata descriptor as a csv file containing at least Lon, Lat and Stratum columns.  
If you already have a geojson file descripbing your strata, you can convert it to a compatible csv file with the ```geojson2csv(fn, vrep = "StratumNam",valrep=c("1511","1512"), outfn)``` function.  
*fn* is the path to geojson file, *vrep* is name of the column containing the Stratum names, default: "StratumNam", *val2rep* values to be replaced, all strata need to be in numeric format, *valrep* values that replace the values from val2rep, *outfn* path where the output csv should be saved.  


### Load transect spacing csv file  
An example transect spacing file for the 2023 HERAS survey is contained within this package:
```
system.file("extdata", "HERAS_spacing_newREDESIGN2023.csv", package="SurvPlan")
``` 
You can create your own spacing csv file containing the following columns:  
"Stratum","Spacing","StratumPlan","Orientation","Mode"
- Stratum is the name of the relvant Stratum  
- Spacing is the spacing between the transects in nautical miles
- StratumPlan is the stratum for which transects should be generated, this is the same as Stratum, unless transects should cross through multiple strata
- Orientation is the orientation of the transects 0 = along the longitude, 90 = along the latitude, in degrees. ANy arbitrary values in degrees can be set
- Mode is either "Parallel"or "zigzag"

When a transect spacing csv file is loaded, the datatable below the map will update. The table is editable and can be downloaded by clicking on one of the buttons above the table.  

### Run transect simulation  
Once the spacings and strata definitions are loaded, transects can be generated by clicking the "Compute Transects" button. A progress bar on the bottom right will indicate whioch transects are currently computed. Once finished, the transects will show up on the map.  

### Tools  

#### Zooming on map  
Zooming can be done through scrolling or by clicking on the +/- button on the top left of the map
#### Background layers
Different map background layers can be selected by clicking on the layer button on the top right of the map
#### Measuring distance
Distances and areas can be computed by clicking on the distance tool on the bottom left
